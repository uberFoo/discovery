<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>(mis)Optimization - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="../">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <noscript>
            <style type="text/css">
                .javascript-only {
                    display: none;
                }
            </style>
        </noscript>

    <!-- Start Google Analytics --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-87779174-1', 'auto'); ga('send', 'pageview'); </script> <!-- End Google Analytics -->
</head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme;
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li class="affix"><a href="README.html">Introduction</a></li><li><a href="01-background/README.html"><strong aria-hidden="true">1.</strong> Background</a></li><li><a href="02-requirements/README.html"><strong aria-hidden="true">2.</strong> Hardware/knowledge requirements</a></li><li><a href="03-setup/README.html"><strong aria-hidden="true">3.</strong> Setting up a development environment</a></li><li><ol class="section"><li><a href="03-setup/linux.html"><strong aria-hidden="true">3.1.</strong> Linux</a></li><li><a href="03-setup/windows.html"><strong aria-hidden="true">3.2.</strong> Windows</a></li><li><a href="03-setup/macos.html"><strong aria-hidden="true">3.3.</strong> macOS</a></li><li><a href="03-setup/verify.html"><strong aria-hidden="true">3.4.</strong> Verify the installation</a></li></ol></li><li><a href="04-meet-your-hardware/README.html"><strong aria-hidden="true">4.</strong> Meet your hardware</a></li><li><a href="05-led-roulette/README.html"><strong aria-hidden="true">5.</strong> LED roulette</a></li><li><ol class="section"><li><a href="05-led-roulette/build-it.html"><strong aria-hidden="true">5.1.</strong> Build it</a></li><li><a href="05-led-roulette/flash-it.html"><strong aria-hidden="true">5.2.</strong> Flash it</a></li><li><a href="05-led-roulette/debug-it.html"><strong aria-hidden="true">5.3.</strong> Debug it</a></li><li><a href="05-led-roulette/the-led-and-delay-abstractions.html"><strong aria-hidden="true">5.4.</strong> The led and delay abstractions</a></li><li><a href="05-led-roulette/the-challenge.html"><strong aria-hidden="true">5.5.</strong> The challenge</a></li><li><a href="05-led-roulette/my-solution.html"><strong aria-hidden="true">5.6.</strong> My solution</a></li></ol></li><li><a href="06-hello-world/README.html"><strong aria-hidden="true">6.</strong> Hello, world!</a></li><li><ol class="section"><li><a href="06-hello-world/panic.html"><strong aria-hidden="true">6.1.</strong> panic!</a></li></ol></li><li><a href="07-registers/README.html"><strong aria-hidden="true">7.</strong> Registers</a></li><li><ol class="section"><li><a href="07-registers/rtrm.html"><strong aria-hidden="true">7.1.</strong> RTRM</a></li><li><a href="07-registers/optimization.html" class="active"><strong aria-hidden="true">7.2.</strong> (mis)Optimization</a></li><li><a href="07-registers/bad-address.html"><strong aria-hidden="true">7.3.</strong> 0xBAAAAAAD address</a></li><li><a href="07-registers/spooky-action-at-a-distance.html"><strong aria-hidden="true">7.4.</strong> Spooky action at a distance</a></li><li><a href="07-registers/type-safe-manipulation.html"><strong aria-hidden="true">7.5.</strong> Type safe manipulation</a></li></ol></li><li><a href="08-leds-again/README.html"><strong aria-hidden="true">8.</strong> LEDs, again</a></li><li><ol class="section"><li><a href="08-leds-again/power.html"><strong aria-hidden="true">8.1.</strong> Power</a></li><li><a href="08-leds-again/configuration.html"><strong aria-hidden="true">8.2.</strong> Configuration</a></li><li><a href="08-leds-again/the-solution.html"><strong aria-hidden="true">8.3.</strong> The solution</a></li></ol></li><li><a href="09-clocks-and-timers/README.html"><strong aria-hidden="true">9.</strong> Clocks and timers</a></li><li><ol class="section"><li><a href="09-clocks-and-timers/for-loop-delays.html"><strong aria-hidden="true">9.1.</strong> for loop delays</a></li><li><a href="09-clocks-and-timers/nop.html"><strong aria-hidden="true">9.2.</strong> NOP</a></li><li><a href="09-clocks-and-timers/one-shot-timer.html"><strong aria-hidden="true">9.3.</strong> One-shot timer</a></li><li><a href="09-clocks-and-timers/initialization.html"><strong aria-hidden="true">9.4.</strong> Initialization</a></li><li><a href="09-clocks-and-timers/busy-waiting.html"><strong aria-hidden="true">9.5.</strong> Busy waiting</a></li><li><a href="09-clocks-and-timers/putting-it-all-together.html"><strong aria-hidden="true">9.6.</strong> Putting it all together</a></li></ol></li><li><a href="10-serial-communication/README.html"><strong aria-hidden="true">10.</strong> Serial communication</a></li><li><ol class="section"><li><a href="10-serial-communication/nix-tooling.html"><strong aria-hidden="true">10.1.</strong> *nix tooling</a></li><li><a href="10-serial-communication/windows-tooling.html"><strong aria-hidden="true">10.2.</strong> Windows tooling</a></li><li><a href="10-serial-communication/loopbacks.html"><strong aria-hidden="true">10.3.</strong> Loopbacks</a></li></ol></li><li><a href="11-usart/README.html"><strong aria-hidden="true">11.</strong> USART</a></li><li><ol class="section"><li><a href="11-usart/send-a-single-byte.html"><strong aria-hidden="true">11.1.</strong> Send a single byte</a></li><li><a href="11-usart/send-a-string.html"><strong aria-hidden="true">11.2.</strong> Send a string</a></li><li><a href="11-usart/buffer-overrun.html"><strong aria-hidden="true">11.3.</strong> Buffer overrun</a></li><li><a href="11-usart/uprintln.html"><strong aria-hidden="true">11.4.</strong> uprintln!</a></li><li><a href="11-usart/receive-a-single-byte.html"><strong aria-hidden="true">11.5.</strong> Receive a single byte</a></li><li><a href="11-usart/echo-server.html"><strong aria-hidden="true">11.6.</strong> Echo server</a></li><li><a href="11-usart/reverse-a-string.html"><strong aria-hidden="true">11.7.</strong> Reverse a string</a></li><li><a href="11-usart/my-solution.html"><strong aria-hidden="true">11.8.</strong> My solution</a></li></ol></li><li><a href="12-bluetooth-setup/README.html"><strong aria-hidden="true">12.</strong> Bluetooth setup</a></li><li><ol class="section"><li><a href="12-bluetooth-setup/linux.html"><strong aria-hidden="true">12.1.</strong> Linux</a></li><li><a href="12-bluetooth-setup/loopback.html"><strong aria-hidden="true">12.2.</strong> Loopback</a></li></ol></li><li><a href="13-serial-over-bluetooth/README.html"><strong aria-hidden="true">13.</strong> Serial over Bluetooth</a></li><li><a href="14-i2c/README.html"><strong aria-hidden="true">14.</strong> I2C</a></li><li><ol class="section"><li><a href="14-i2c/the-general-protocol.html"><strong aria-hidden="true">14.1.</strong> The general protocol</a></li><li><a href="14-i2c/lsm303dlhc.html"><strong aria-hidden="true">14.2.</strong> LSM303DLHC</a></li><li><a href="14-i2c/read-a-single-register.html"><strong aria-hidden="true">14.3.</strong> Read a single register</a></li><li><a href="14-i2c/the-solution.html"><strong aria-hidden="true">14.4.</strong> The solution</a></li><li><a href="14-i2c/read-several-registers.html"><strong aria-hidden="true">14.5.</strong> Read several registers</a></li></ol></li><li><a href="15-led-compass/README.html"><strong aria-hidden="true">15.</strong> LED compass</a></li><li><ol class="section"><li><a href="15-led-compass/take-1.html"><strong aria-hidden="true">15.1.</strong> Take 1</a></li><li><a href="15-led-compass/solution-1.html"><strong aria-hidden="true">15.2.</strong> Solution 1</a></li><li><a href="15-led-compass/take-2.html"><strong aria-hidden="true">15.3.</strong> Take 2</a></li><li><a href="15-led-compass/solution-2.html"><strong aria-hidden="true">15.4.</strong> Solution 2</a></li><li><a href="15-led-compass/magnitude.html"><strong aria-hidden="true">15.5.</strong> Magnitude</a></li><li><a href="15-led-compass/calibration.html"><strong aria-hidden="true">15.6.</strong> Calibration</a></li></ol></li><li><a href="16-punch-o-meter/README.html"><strong aria-hidden="true">16.</strong> Punch-o-meter</a></li><li><ol class="section"><li><a href="16-punch-o-meter/gravity-is-up.html"><strong aria-hidden="true">16.1.</strong> Gravity is up?</a></li><li><a href="16-punch-o-meter/the-challenge.html"><strong aria-hidden="true">16.2.</strong> The challenge</a></li><li><a href="16-punch-o-meter/my-solution.html"><strong aria-hidden="true">16.3.</strong> My solution</a></li></ol></li><li><a href="explore.html"><strong aria-hidden="true">17.</strong> What's left for you to explore</a></li><li class="spacer"></li><li class="affix"><a href="appendix/1-general-troubleshooting/README.html">General troubleshooting</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons javascript-only">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title"></h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="searchbar-outer" class="searchbar-outer">
                    <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                </div>
                <div id="searchresults-outer" class="searchresults-outer">
                    <div class="searchresults-header" id="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="07-registers/optimization.html#misoptimization" id="misoptimization"><h1>(mis)Optimization</h1></a>
<p>Reads/writes to registers are quite special. I may even dare to say that they are embodiment of side
effects. In the previous example we wrote four different values to the same register. If you didn't
know that address was a register, you may have simplified the logic to just write the final value <code>1 &lt;&lt; (11 + 16)</code> into the register.</p>
<p>Actually, LLVM, the compiler's backend / optimizer, does not know we are dealing with a register and
will merge the writes thus changing the behavior of our program. Let's check that really quick.</p>
<pre><code class="language-console">$ cargo run --release

(gdb) next

(gdb) disassemble /m
Dump of assembler code for function registers::main:
10      fn main() -&gt; ! {
   0x08000188 &lt;+0&gt;:     push    {r7, lr}

11          aux7::init();
   0x0800018a &lt;+2&gt;:     bl      0x80001a4 &lt;aux7::init&gt;

12
13          unsafe {
14              // A magic address!
15              const GPIOE_BSRR: u32 = 0x48001018;
16
17              // Turn on the &quot;North&quot; LED (red)
18              *(GPIOE_BSRR as *mut u32) = 1 &lt;&lt; 9;
19
20              // Turn on the &quot;East&quot; LED (green)
21              *(GPIOE_BSRR as *mut u32) = 1 &lt;&lt; 11;
22
23              // Turn off the &quot;North&quot; LED
24              *(GPIOE_BSRR as *mut u32) = 1 &lt;&lt; (9 + 16);
25
26              // Turn off the &quot;East&quot; LED
27              *(GPIOE_BSRR as *mut u32) = 1 &lt;&lt; (11 + 16);
=&gt; 0x0800018e &lt;+6&gt;:     movw    r0, #4120       ; 0x1018
   0x08000192 &lt;+10&gt;:    mov.w   r1, #134217728  ; 0x8000000
   0x08000196 &lt;+14&gt;:    movt    r0, #18432      ; 0x4800
   0x0800019a &lt;+18&gt;:    str     r1, [r0, #0]    ; &lt;- 1

28          }
29
30          loop {}
   0x0800019c &lt;+20&gt;:    b.n     0x800019c &lt;registers::main+20&gt;

End of assembler dump.
</code></pre>
<p>The state of the LEDs didn't change this time! The <code>str</code> instruction is the one that writes a value
to the register. Our <em>debug</em> (unoptimized) program had four of them, one for each write to the
register, but the <em>release</em> (optimized) program only has one.</p>
<p>We can check that using <code>objdump</code>:</p>
<pre><code class="language-console">$ arm-none-eabi-objdump -Cd target/thumbv7em-none-eabihf/debug/registers
08000188 &lt;registers::main&gt;:
 8000188:       b580            push    {r7, lr}
 800018a:       b086            sub     sp, #24
 800018c:       f000 f86a       bl      8000264 &lt;aux7::init&gt;
 8000190:       9005            str     r0, [sp, #20]
 8000192:       e7ff            b.n     8000194 &lt;registers::main+0xc&gt;
 8000194:       e7ff            b.n     8000196 &lt;registers::main+0xe&gt;
 8000196:       f241 0018       movw    r0, #4120       ; 0x1018
 800019a:       f6c4 0000       movt    r0, #18432      ; 0x4800
 800019e:       f44f 7100       mov.w   r1, #512        ; 0x200
 80001a2:       6001            str     r1, [r0, #0]    ; &lt;- 1
 80001a4:       e7ff            b.n     80001a6 &lt;registers::main+0x1e&gt;
 80001a6:       f241 0018       movw    r0, #4120       ; 0x1018
 80001aa:       f6c4 0000       movt    r0, #18432      ; 0x4800
 80001ae:       f44f 6100       mov.w   r1, #2048       ; 0x800
 80001b2:       6001            str     r1, [r0, #0]    ; &lt;- 2
 80001b4:       2019            movs    r0, #25
 80001b6:       4601            mov     r1, r0
 80001b8:       2809            cmp     r0, #9
 80001ba:       9104            str     r1, [sp, #16]
 80001bc:       d62c            bvs.n   8000218 &lt;registers::main+0x90&gt;
 80001be:       e7ff            b.n     80001c0 &lt;registers::main+0x38&gt;
 80001c0:       9804            ldr     r0, [sp, #16]
 80001c2:       f000 011f       and.w   r1, r0, #31
 80001c6:       2201            movs    r2, #1
 80001c8:       fa02 f101       lsl.w   r1, r2, r1
 80001cc:       f06f 021f       mvn.w   r2, #31
 80001d0:       4210            tst     r0, r2
 80001d2:       9103            str     r1, [sp, #12]
 80001d4:       d127            bne.n   8000226 &lt;registers::main+0x9e&gt;
 80001d6:       e7ff            b.n     80001d8 &lt;registers::main+0x50&gt;
 80001d8:       f241 0018       movw    r0, #4120       ; 0x1018
 80001dc:       f6c4 0000       movt    r0, #18432      ; 0x4800
 80001e0:       9903            ldr     r1, [sp, #12]
 80001e2:       6001            str     r1, [r0, #0]    ; &lt;- 3
 80001e4:       201b            movs    r0, #27
 80001e6:       4602            mov     r2, r0
 80001e8:       280b            cmp     r0, #11
 80001ea:       9202            str     r2, [sp, #8]
 80001ec:       d622            bvs.n   8000234 &lt;registers::main+0xac&gt;
 80001ee:       e7ff            b.n     80001f0 &lt;registers::main+0x68&gt;
 80001f0:       9802            ldr     r0, [sp, #8]
 80001f2:       f000 011f       and.w   r1, r0, #31
 80001f6:       2201            movs    r2, #1
 80001f8:       fa02 f101       lsl.w   r1, r2, r1
 80001fc:       f06f 021f       mvn.w   r2, #31
 8000200:       4210            tst     r0, r2
 8000202:       9101            str     r1, [sp, #4]
 8000204:       d11d            bne.n   8000242 &lt;registers::main+0xba&gt;
 8000206:       e7ff            b.n     8000208 &lt;registers::main+0x80&gt;
 8000208:       f241 0018       movw    r0, #4120       ; 0x1018
 800020c:       f6c4 0000       movt    r0, #18432      ; 0x4800
 8000210:       9901            ldr     r1, [sp, #4]
 8000212:       6001            str     r1, [r0, #0]    ; &lt;- 4
 8000214:       e7ff            b.n     8000216 &lt;registers::main+0x8e&gt;
 8000216:       e7fe            b.n     8000216 &lt;registers::main+0x8e&gt;
 8000218:       f244 205c       movw    r0, #16988      ; 0x425c
 800021c:       f6c0 0000       movt    r0, #2048       ; 0x800
 8000220:       f003 fed6       bl      8003fd0 &lt;core::panicking::panic&gt;
 8000224:       defe            udf     #254    ; 0xfe
 8000226:       f244 20a4       movw    r0, #17060      ; 0x42a4
 800022a:       f6c0 0000       movt    r0, #2048       ; 0x800
 800022e:       f003 fecf       bl      8003fd0 &lt;core::panicking::panic&gt;
 8000232:       defe            udf     #254    ; 0xfe
 8000234:       f244 20bc       movw    r0, #17084      ; 0x42bc
 8000238:       f6c0 0000       movt    r0, #2048       ; 0x800
 800023c:       f003 fec8       bl      8003fd0 &lt;core::panicking::panic&gt;
 8000240:       defe            udf     #254    ; 0xfe
 8000242:       f244 20d4       movw    r0, #17108      ; 0x42d4
 8000246:       f6c0 0000       movt    r0, #2048       ; 0x800
 800024a:       f003 fec1       bl      8003fd0 &lt;core::panicking::panic&gt;
 800024e:       defe            udf     #254    ; 0xfe
</code></pre>
<p>How do we prevent LLVM from misoptimizing our program? We use <em>volatile</em> operations instead of plain
reads/writes:</p>
<pre><pre class="playpen"><code class="language-rust">#![no_main]
#![no_std]

extern crate aux7;
#[macro_use]
extern crate cortex_m;
#[macro_use]
extern crate cortex_m_rt;

use core::ptr;

entry!(main);

fn main() -&gt; ! {
    aux7::init();

    unsafe {
        // A magic address!
        const GPIOE_BSRR: u32 = 0x48001018;

        // Turn on the &quot;North&quot; LED (red)
        ptr::write_volatile(GPIOE_BSRR as *mut u32, 1 &lt;&lt; 9);

        // Turn on the &quot;East&quot; LED (green)
        ptr::write_volatile(GPIOE_BSRR as *mut u32, 1 &lt;&lt; 11);

        // Turn off the &quot;North&quot; LED
        ptr::write_volatile(GPIOE_BSRR as *mut u32, 1 &lt;&lt; (9 + 16));

        // Turn off the &quot;East&quot; LED
        ptr::write_volatile(GPIOE_BSRR as *mut u32, 1 &lt;&lt; (11 + 16));
    }

    loop {}
}
</code></pre></pre>
<p>If we look at the disassemble of this new program compiled in release mode:</p>
<pre><code class="language-console">$ arm-none-eabi-objdump -Cd target/thumbv7em-none-eabihf/release/registers
08000188 &lt;registers::main&gt;:
 8000188:       b580            push    {r7, lr}
 800018a:       f000 f814       bl      80001b6 &lt;aux7::init&gt;
 800018e:       f241 0018       movw    r0, #4120       ; 0x1018
 8000192:       f44f 7100       mov.w   r1, #512        ; 0x200
 8000196:       f6c4 0000       movt    r0, #18432      ; 0x4800
 800019a:       6001            str     r1, [r0, #0]    ; &lt;- 1
 800019c:       f44f 6100       mov.w   r1, #2048       ; 0x800
 80001a0:       6001            str     r1, [r0, #0]    ; &lt;- 2
 80001a2:       f04f 7100       mov.w   r1, #33554432   ; 0x2000000
 80001a6:       6001            str     r1, [r0, #0]    ; &lt;- 3
 80001a8:       f04f 6100       mov.w   r1, #134217728  ; 0x8000000
 80001ac:       6001            str     r1, [r0, #0]    ; &lt;- 4
 80001ae:       e7fe            b.n     80001ae &lt;registers::main+0x26&gt;
</code></pre>
<p>We see that the four writes (<code>str</code> instructions) are preserved. If you run it (use <code>stepi</code>), you'll
also see that behavior of the program is preserved.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="07-registers/rtrm.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="07-registers/bad-address.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="07-registers/rtrm.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="07-registers/bad-address.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if (getComputedStyle(document.querySelector(".fa")).fontFamily !== "FontAwesome") {
                var link = document.createElement('link');
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = '_FontAwesome/css/font-awesome.css';
                document.head.insertBefore(link, document.head.firstChild)
            }
        </script>

        

        

        

        
        <script src="searchindex.js" type="text/javascript" charset="utf-8"></script>
        
        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
